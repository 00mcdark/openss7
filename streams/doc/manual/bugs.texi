@c -*- texinfo -*- vim: ft=texinfo tw=100 nocin nosi
@c =========================================================================
@c
@c @(#) $Id: bugs.texi,v 0.9.2.3 2007/02/26 15:29:46 brian Exp $
@c
@c =========================================================================
@c
@c Copyright (c) 2001-2006  OpenSS7 Corporation <http://www.openss7.com/>
@c
@c All Rights Reserved.
@c
@c Permission is granted to make and distribute verbatim copies of this
@c manual provided the copyright notice and this permission notice are
@c preserved on all copies.
@c
@c Permission is granted to copy and distribute modified versions of this
@c manual under the conditions for verbatim copying, provided that the
@c entire resulting derived work is distributed under the terms of a
@c permission notice identical to this one.
@c 
@c Since the Linux kernel and libraries are constantly changing, this
@c manual page may be incorrect or out-of-date.  The author(s) assume no
@c responsibility for errors or omissions, or for damages resulting from
@c the use of the information contained herein.  The author(s) may not
@c have taken the same level of care in the production of this manual,
@c which is licensed free of charge, as they might when working
@c professionally.
@c 
@c Formatted or processed versions of this manual, if unaccompanied by
@c the source, must acknowledge the copyright and authors of this work.
@c
@c -------------------------------------------------------------------------
@c
@c U.S. GOVERNMENT RESTRICTED RIGHTS.  If you are licensing this Software
@c on behalf of the U.S. Government ("Government"), the following
@c provisions apply to you.  If the Software is supplied by the Department
@c of Defense ("DoD"), it is classified as "Commercial Computer Software"
@c under paragraph 252.227-7014 of the DoD Supplement to the Federal
@c Acquisition Regulations ("DFARS") (or any successor regulations) and the
@c Government is acquiring only the license rights granted herein (the
@c license rights customarily provided to non-Government users).  If the
@c Software is supplied to any unit or agency of the Government other than
@c DoD, it is classified as "Restricted Computer Software" and the
@c Government's rights in the Software are defined in paragraph 52.227-19
@c of the Federal Acquisition Regulations ("FAR") (or any successor
@c regulations) or, in the cases of NASA, in paragraph 18.52.227-86 of the
@c NASA Supplement to the FAR (or any successor regulations).
@c
@c =========================================================================
@c 
@c Commercial licensing and support of this software is available from
@c OpenSS7 Corporation at a fee.  See http://www.openss7.com/
@c 
@c =========================================================================
@c
@c Last Modified $Date: 2007/02/26 15:29:46 $ by $Author: brian $
@c
@c =========================================================================

@table @code
@item 004. 2007-02-26T08:25:09-0700

Jérémy Composte pointed out error in clone.c.  When an automatic clone minor device was unregistered,
it was unregistering the modid instead of the major number.  This was not noticed because all
OpenSS7 drivers have the same modid as major number (strconf does this automatically).

@emph{*fixed*} in @command{streams-0.9.2.2}

@item 003. 2007-02-26T08:25:09-0700

Jérémy Composte pointed out syntax error in strsched.c that kept synqs from compiling properly.

@emph{*fixed*} in @command{streams-0.9.2.2}

@item 002. 2006-09-24T20:02:00+0000

Discovered asynchronous thread cancellation inconsistencies in libLiS libpLiS by inspection during
documentation.  isastream(2), fattach(2) were not performing proper asynchronous thread
cancellation suppression so that these function contained a cancellation point when the should not.

@emph{*fixed*} in @command{streams-0.7a.6.rc3}

@item 001. 2006-07-05T21:54:49+0000

Fedora Core 5 reports a rwlock bug during udp module unloading as follows:

@example
BUG: rwlock wrong CPU on CPU#0, rmmod/7515
Call Trace:
  @{rwlock_bug+100@}
  @{_raw_write_unlock+88@}
  @{:streams:unregister_strnod+211@}
  @{:streams:unregister_clone+64@}
  @{:streams:unregister_strdev+24@}
  @{:streams_udp:udpterminate+26@}
  @{sys_delete_module+406@}
  @{system_call+126@}
@end example

It appears that unregister_strnod() is scheduling while holding a write lock on cdevsw_lock.  This
is probably in iput() called within cmin_del.

@emph{*fixed*} in @command{streams-0.7a.6.rc2}

There were a number of places where sleeping functions were called with spin-locks held, causing the
CPU awaking from the sleep to sometimes be different from the CPU that took the lock.  This was
buggy, so I reworked all of these cdev and fmod sections to handle spin locks properly.  FC5/SMP on
HT no longer reports these bugs.
@end table

