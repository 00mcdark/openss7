'\" rtp
.\" -*- nroff -*- vim: ft=nroff
.\"
.\" @(#) $Id: nsdev.4.man,v 0.9.2.1 2004/03/01 02:44:06 brian Exp $
.\"
.\" =========================================================================
.\"
.\" Copyright (C) 2001-2003  OpenSS7 Corporation <www.openss7.com>
.\"
.\" All Rights Reserved.
.\"
.\" Permission is granted to make and distribute verbatim copies of this
.\" manual provided the copyright notice and this permission notice are
.\" preserved on all copies.
.\"
.\" Permission is granted to copy and distribute modified versions of this
.\" manual under the conditions for verbatim copying, provided that the
.\" entire resulting derived work is distributed under the terms of a
.\" permission notice identical to this one
.\" 
.\" Since the Linux kernel and libraries are constantly changing, this
.\" manual page may be incorrect or out-of-date.  The author(s) assume no
.\" responsibility for errors or omissions, or for damages resulting from
.\" the use of the information contained herein.  The author(s) may not
.\" have taken the same level of care in the production of this manual,
.\" which is licensed free of charge, as they might when working
.\" professionally.
.\" 
.\" Formatted or processed versions of this manual, if unaccompanied by
.\" the source, must acknowledge the copyright and authors of this work.
.\"
.\" -------------------------------------------------------------------------
.\"
.\" U.S. GOVERNMENT RESTRICTED RIGHTS.  If you are licensing this Software
.\" on behalf of the U.S. Government ("Government"), the following
.\" provisions apply to you.  If the Software is supplied by the Department
.\" of Defense ("DoD"), it is classified as "Commercial Computer Software"
.\" under paragraph 252.227-7014 of the DoD Supplement to the Federal
.\" Acquisition Regulations ("DFARS") (or any successor regulations) and the
.\" Government is acquiring only the license rights granted herein (the
.\" license rights customarily provided to non-Government users).  If the
.\" Software is supplied to any unit or agency of the Government other than
.\" DoD, it is classified as "Restricted Computer Software" and the
.\" Government's rights in the Software are defined in paragraph 52.227-19
.\" of the Federal Acquisition Regulations ("FAR") (or any success
.\" regulations) or, in the cases of NASA, in paragraph 18.52.227-86 of the
.\" NASA Supplement to the FAR (or any successor regulations).
.\"
.\" =========================================================================
.\" 
.\" Commercial licensing and support of this software is available from
.\" OpenSS7 Corporation at a fee.  See http://www.openss7.com/
.\" 
.\" =========================================================================
.\"
.\" Last Modified $Date: 2004/03/01 02:44:06 $ by $Author: brian $
.\"
.\" =========================================================================
.so streams.macros
.R1
bracket-label "\fR[\fB" "\fR]" "\fR, \fB"
no-default-database
database streams.refs
accumulate
move-punctuation
abbreviate A
join-authors ", " ", " " and "
et-al " et al" 2 3
abbreviate-label-ranges ".."
sort-adjacent-labels
.R2
.\"
.\"
.TH NSDEV 4 "$Date: 2004/03/01 02:44:06 $" "$Name:  $" "Linux Fast-STREAMS Devices"
.\"
.\"
.SH NAME
.B nsdev
\- named \fISTREAMS\fP device
.\"
.\"
.SH SYNOPSIS
.PP
.B #include <sys/stropts.h>
.HP
.BI "int " fd " = open(" \*(lq/dev/xxxyyy\*(rq ", " oflags );
.\"
.\"
.SH DESCRIPTION
.PP
.B nsdev
is a \*(lqNamed STREAMS Device\*(rq pseudo-device driver similar to
.BR clone (4).
.B nsdev
is perhaps the only major device number that is ever needed by a
.I STREAMS
device driver.
.PP
Whereas the
.BR clone (4)
pseudo-device driver transforms the device number
.I dev
into
.BI makedevice(getminor( dev "), " 0 ),
the
.B nsdev
pseudo-device driver transforms the device number
.I dev
into
.BI makedevice( major ", getminor(" dev )),
where
.I major
is determined from the name of the device rather than the device number.
.PP
To determine the
.I major
component of the device number,
.B nsdev
looks for a registered
.I STREAMS
device with the same initial substring as the name of the device opened
.RI ( xxx
in the SYNOPSIS above).
.PP
All minor device opened via the
.B nsdev
pseudo-device driver are considered clonable minor devices a similar manner
to
.BR clone (4)
treating all major devices opened as a clonable major device.
.\"
.\"
.SH NOTICES
.PP
Performing an
.BR open (2)
of the
.B nsdev
can result in the loading of (or an attempt to load) the kernel module
named
.RI \*(lq streams-\fBxxx\fP.o \*(rq.
.PP
If the device opened is a symbolic link, the name of the actual file is the
name used for determining the
.I major
device number of the cloned device.
If the device opened is a hard link, the name of the opened file is the name
used for determining the
.I major
device number of the cloned device.
.PP
.B nsdev
is used by the
.I Linux Fast-STREAMS
system provided drivers to limit the use of major device numbers to a single
major device number for the
.I STREAMS
system installed device drivers.
Clonable minor devices are allocated against a single
.I STREAMS
system major device number rather than allocating new major device numbers for
each facility.
.\"
.\"
.SH EXAMPLES
.PP
If the following is peformed to create the device:
.sp
.nf
$> mknod -m 0666 /dev/streams04 c 56 3
$> ln -s /dev/streams04 /dev/ticlts
.fi
.sp
then opening
.RI \*(lq /dev/ticlts \*(rq
will result in opening minor device number
.I 3
of the
.RI \*(lq streams \*(rq
device.
.\"
.\"
.SH "SEE ALSO"
.PP
.BR clone (4),
.BR sad (4).
.\"
.\"
.SH BUGS
.PP
.B nsdev
has no known bugs.
.\"
.\"
.SH CONFORMANCE
.PP
.B nsdev
is a
.I Linux Fast-STREAMS
specific mechanism.
.\"
.\"
.SH HISTORY
.PP
.B nsdev
first appeared in
.IR "Linux Fast-STREAMS" .
.\"
.\"
.[
$LIST$
.]
.TI
