.\" -*- nroff -*-
.\"
.\" @(#) $Id: sctp.7.man,v 0.9.2.6 2002/05/24 22:09:45 brian Exp $
.\"
.\" =========================================================================
.\"
.\" This manpage is Copyright (C) 2001-2002  OpenSS7 Corp. <www.openss7.com>
.\"
.\" All Rights Reserved.
.\"
.\" Permission is granted to make and distribute verbatim copies of this
.\" manual provided the copyright notice and this permission notice are
.\" preserved on all copies.
.\"
.\" Permission is granted to copy and distribute modified versions of this
.\" manual under the conditions for verbatim copying, provided that the
.\" entire resulting derived work is distributed under the terms of a
.\" permission notice identical to this one
.\" 
.\" Since the Linux kernel and libraries are constantly changing, this
.\" manual page may be incorrect or out-of-date.  The author(s) assume no
.\" responsibility for errors or omissions, or for damages resulting from
.\" the use of the information contained herein.  The author(s) may not
.\" have taken the same level of care in the production of this manual,
.\" which is licensed free of charge, as they might when working
.\" professionally.
.\" 
.\" Formatted or processed versions of this manual, if unaccompanied by
.\" the source, must acknowledge the copyright and authors of this work.
.\"
.\" =========================================================================
.\"
.\" Modified $Date: 2002/05/24 22:09:45 $ by $Author: brian $
.\"
.\" =========================================================================
.TH SCTP 7 "8 May 2002" "Linux Man Page" "Linux Programmer's Manual"
.SH "NAME"
sctp \- SCTP protocol.
.SH "SYNOPSIS"
.nf
\fB#include <sys/socket.h>\fR

\fB#include <netinet/in.h>\fR

\fBsctp_socket = socket(PF_INET, \fISOCK_SEQPACKET\fB, 0);
\fBsctp_socket = socket(PF_INET, \fISOCK_SEQPACKET\fB, IPPROTO_SCTP);
\fBsctp_socket = socket(PF_INET, \fISOCK_STREAM\fB, IPPROTO_SCTP);
\fBsctp_socket = socket(PF_INET, \fISOCK_RDM\fB, IPPROTO_SCTP);
.fi

.SH "DESCRIPTION"
This is an implementation of the SCTP (Stream Tranmission Control Protocol)
defined in RFC2960 with a \fBtcp\fR(7)-compatible \fISOCK_STREAM\fR socket
interface similar to draft-ietf-tsvwg-sctpsocket-03.  SCTP provides reliable
delivery of sequenced or unsequenced packets over a full duplex connection
between two sockets on top of \fBip\fR(7).  SCTP can guarantee that the data
arrives in order on a stream, if requested, and retransmits lost packets.  It
generates and checks a per packet checksum to catch transmission errors.  SCTP
\fISOCK_SEQPACKET\fR sockets preserve message boundaries, Nagle at the
association level, and provide sequenced and unsequenced reliable and partial
reliable delivery; \fISOCK_RDM\fR sockets preserve message boundaries, do
not Nagle, and provide only unsequenced but reliable or partially reliable
delivery; \fISOCK_STREAM\fR sockets do not preserve message boundaries and
Nagle at the stream level similar to \fBtcp\fR(7).

A fresh SCTP socket has no remote or local address and is not fully specified.
To create an outgoing SCTP association use \fBconnect\fR(2) to establish an
association with another SCTP endpoint.  To receive incoming associations
\fBbind\fR(2) the socket first to a number of local addresses and a port and
then call \fBlisten\fR(2) to put the socket into listening state.  After
that a new socket for each incoming association can be accepted using
\fBaccept\fR(2).  A socket which has had \fBaccept\fR(2) or
\fBconnect\fR(2) successfully called on it is fully specified and may
transmit data.  Data cannot be transmitted on listening or not yet connected
sockets.

SCTP supports large windows to support links with high latency or bandwidth.
Large SCTP windows can be used by increasing the send and receive buffer
sizes.  They can be set globally with the \fBnet.core.wmem_default\fR and
\fBnet.core.rmem_default\fR sysctls, or on individual sockets by using the
\fISO_SNDBUF\fR and \fISO_RCVBUF\fR socket options.  The maximum sizes for
socket buffers are limited by the \fBnet.core.wmem_max\fR and
\fBnet.core.rmem_max\fR sysctls.  See \fBsocket\fR(7) for more
information.
.PP
.B Sending Data
.PP
When sending data, the specific destination address within the association to
which to send the data can be specified by providing a valid destination
address as an argument to \fBsendto\fR(2) or \fBsendmsg\fR(2).  Data sent
with \fBsend\fR(2) or \fBwrite\fR(2) will use SCTP's destination transport
address selection policies for transmission and retransmission.  The stream
upon which to send the data can also be set with the \fBSCTP_SID\fR socket
option on a socket basis with \fBsetsockopt\fR(2) or on a per-message basis
with \fBsendmsg\fR(2).  In addition, the \fBip\fR(7) \fIIP_PKTINFO\fR
option can be used with \fBsendmsg\fR(2) to specify the interface, first-hop
destination address and source address to be used in the outbound packet on
\fISOCK_SEQPACKET\fR and \fISOCK_RDM\fR sockets.  IP options can also be
specified for the outbound packet with the \fBip\fR(7) \fIIP_OPTIONS\fR or
\fBIP_RETOPTS\fR control messages to \fBsendmsg\fR(2).
.PP
For \fISOCK_SEQPACKET\fR socket, send operations may also use the
\fBMSG_MORE\fR flag when sending with \fBsend\fR(2), \fBsendto\fR(2) or
\fBsendmsg\fR(2) to indicate that the next write operation will provide
additional data belonging to the same packet.
\fISOCK_STREAM\fR sockets do not support send options and do not return
the \fBMSG_TRUNC\fR flag on send operations.
.PP
\fISOCK_SEQPACKET\fR or \fISOCK_STREAM\fR socket does not have sufficient
room to buffer the sent data, it buffers what it can and returns the amount of
user data buffered.  \fISOCK_RDM\fR sockets wait for sufficient room to
buffer the entire sent packet before returning.  \fISOCK_SEQPACKET\fR and
\fISOCK_STREAM\fR sockets will segment large data writes in to smaller
segments for delivery to the peer.
.PP
For \fISOCK_SEQPACKET\fR and \fISOCK_RDM\fR sockets, all receive
operations return only one packet, or a portion of one packet.  When the
packet is smaller than the passed buffer only that much data is returned, when
it is larger the packet is truncated and the \fBMSG_TRUNC\fR flag is set.
Subsequent \fBrecv\fR or \fBread\fB(2), or a subsequent
\fBrecvfrom\fR(2) or \fBrecgmsg\fR for the same stream will return the
remainder of the packet.  SCTP \fISOCK_SEQPACKET\fR sockets return the
\fBMSG_EOR\fR flag when the end of the packet has been received
successfully.
.PP
For \fISOCK_STREAM\fR sockets, all receive operations return only the amount
of data available on the current stream.  \fBMSG_TRUNC\fR and
\fBMSG_EOR\fR are never set for \fISOCK_STREAM\fR sockets.
.PP
IP options may be sent or received using the socket options described in
\fBip\fR(7).  They are only processed by the kernel when the appropriate
sysctl is enabled (but still passed to the user even when it is turned off).
See \fBip\fR(7).
.PP
When the \fBMSG_DONTROUTE\fR flag is set on sending, the destination address
must refer to a local interface address and the packet is only sent to that
interface.
.PP
SCTP fragments a packet when its total length exceeds the association MTU
(Maximum Transmission Unit).  A more network friendly alternative is to use
path MTU discovery as described in the \fBIP_PMTU_DISCOVER\fR section of
\fBip\fR(7).
.PP
SCTP supports urgent data similar to \fBtcp\fR(7).  Urgent data is used to
signal the receiver that some important message is part of the data stream and
that it should be processed as soon as possible.  Urgent data is always sent
out of order.  To send urgent (or out of order) data specify the
\fBMSG_OOB\fR option to \fBsend\fR(2), \fBsendto\fR(2), or
\fBsendmsg\fR(2).  When urgent data is received, the kernel sends a
\fBSIGURG\fR signal to the reading process or the process or process group
that has been set for the socket using the \fBFIOCSPGRP\fR or
\fBFIOCSETOWN\fR ioctls.  When the \fBSO_OOBINLINE\fR socket option is
enabled, urgent data is put into the normal data stream (and can be tested for
by the \fBSIOCATMARK\fR ioctl), otherwise it can be only received when the
\fBMSG_OOB\fR flag is set for \fBrecvmsg\fR(2).
.SS "ADDRESS FORMATS"
SCTP is built on top of IP (see \fBip\fR(7)).  The address formats defined
by \fBip\fR(7) apply to SCTP.  SCTP uses the IPv4 \fBsockaddr_in\fR
address format described in \fBip\fR(7).
.PP
SCTP supports multiple-stream point-to-point communication within multi-homed
associations; broadcasting and multicasting are not supported.
.PP
In addition to normal IP addressing, SCTP provides extensions on the
\fBbind\fR(2), \fBaccept\fR, \fBconnect\fR(2), \fBgetsockname\fR(2),
and \fBgetpeername\fR(2) system calls.  These functions normally take or
return a single \fBsockaddr_in\fR as an address argument.  When used in
conjunction with a SCTP socket on or to a multi-homed host, these calls will
accept or return an array of \fBsockaddr_in\fR structures.  The number of
addresses in the structure is indicated by the length of the structure and the
protocol family of the socket.  SCTP will only support one port number being
specified in the address list.  (Note: Linux only provides
\fIMAX_SOCK_ADDR\fR as a maximum size of the socket address length.  This is
current 128 bytes or 8 \fBsockaddr_in\fR structures.)

Multiple addresses provided to the \fBbind\fR(2) system call will be
interpreted as multiple local addresses to provide to the peer at connection
time as well as the local address/port combinations upon which a listening
socket will accept incoming associations.  A call to \fBaccept\fR(2)
requesting the source address of the peer will return multiple transport
addresses if the connecting peer is multihomed.  Multiple addresses provided
to the \fBconnect\fR(2) system call will be interpreted as multiple
destination address/port combinations to which to form an association. The
\fBgetpeername\fR(2) system call returns the list of destination
address/port combinations to which the socket is connected.  The
\fBgetsockname\fR(2) system call returnes the list of local address/port
combinations to which the socket is bound.
.TP
.BR getsockname (2)
A call to \fBgetsockname\fR(2) can provide multiple bound transport
addresses for a multihomed SCTP host when the socket is bound to multiple
addresses using \fBbind\fR(2).  The first address in the list is the primary
address to which the SCTP socket is bound.  This is the first address that
will be attempted to be used as a source address when sending an \fIINIT\fR
chunk to the SCTP peer as a result of a call to \fBconnect\fR(2).
Otherwise, the order of the addresses has no significance.

When the SCTP socket is not bound to any address, the call to
\fBgetsockname\fR(2) returns a socket address with address family
\fIAF_UNSPEC\fR.

As a result of binding to \fIINADDR_ANY\fR or the \fBADD-IP\fR extension
to SCTP, subsequent calls to \fBgetsockname\fR(2) may return different
addresses depending on the state of the connection and resulting from the
exchange of \fIASCONF\fR control chunks.  This list of transport addresses
returned by \fBgetsockname\fR(2) represents the current list of local
transport addresses bound to the endpoint.

When the SCTP connection is multi-homed or supports \fBADD-IP\fR, this
behavior is different from \fBtcp\fR(7) and other connection-oriented
protocols, whose bound address does not change during the lifespan of a
connection.
.TP
.BR getpeername (2)
A call to \fBgetpeername\fR(2) can provide multiple peer transport addresses
for a multihomed SCTP peer when the socket is connecting or connected to
multiple addresses using \fBconnect\fR(2).  The first address is always the
current primary destination transport address.  The current primary
destination transport address is the address to which all SCTP messages will
be sent in the absence of congestion or failure.

As a result of connecting to multiple transport addresses using
\fBconnect\fR(2) or the \fBADD-IP\fR extension to SCTP, the membership of
the list of transport addresses returned by \fBgetpeername\fR(2) may change
due to the state of the socket or resulting from the exchange of
\fBASCONF\fR control chunks.

When the SCTP connection is multi-homed or supports \fBADD-IP\fR, this
behavior is different from \fBtcp\fR(7) and other connection-oriented
protocol, whose peer address does not change during the lifespan of a
connection.
.SS "SOCKET CALLS"
.PP
Socket calls for SCTP \fISOCK_STREAM\fR, \fISOCK_SEQPACKET\fR and
\fISOCK_RDM\fR sockets are different in some respects (addressing and
options) than their \fBtcp\fR(7) or \fBudp\fR(7) counterparts.  These
differences are described here.  For common behavior, please see the indicated
manual page in Section 2.
.TP
.BR bind (2)
A call to \fBbind\fR(2) can provide multiple address if the host is
multi-homed.  Binds to \fIINADDR_ANY\fR will result in a binding to all of
the local transport addresses belonging to host which do not cause a conflict
at the time that a connection is formed.  The local port number is assigned at
the time that the bind is called.

Binding to a socket address with address family \fIAF_UNSPEC\fR will cause
the socket to be unbound from all transport addresses.

SCTP supports binding of multiple sockets to the same transport address
providing that the socket option \fISO_REUSEADDR\fR (see
\fBsocket\fR(7)) is set on the sockets and that no sockets have executed
\fBlisten\fR(2) bound to the same transport address.
.TP
.BR accept (2)
A call to \fBaccept\fR(2) requesting the peer address of the connection will
return multiple transport addresses if the connecting peer is multi-homed.
The first transport address in the array is the primary transport address of
the connecting peer.  The primary transport address is the address upon which
the SCTP \fIINIT\fR message was received.  Otherwise, \fBaccept\fR(2) is
unchanged.
.TP
.BR connect (2)
A call to \fBconnect\fR(2) can provide multiple destination transport
addresses if the peer host is multi-homed.  If an \fIINIT\fR chunk sent to
the first destination transport address is not acknowledged, the next
\fIINIT\fR chunk will be sent to the next address in the list.  This will
occur until an acknolwegement is received from one of the addresses or the
connection attempt times out.  Each address will be retried
\fBsctp_max_init_retries\fR times before the connection process is
considered to have timed out.  Broadcast and Multicast addresses are permitted
for the call to \fBconnect\fR(2) but will not form an endpoint address in
the association.  This feature permits fast and reliable initialization of
SCTP associations.

Connecting to a socket address with address family \fIAF_UNSPEC\fR will
sockets engaged in active connections to be disconnected.
.TP
.BR read "(2), " recv "(2), " recvfrom "(2) and " recvmsg "(2)"
SCTP preserves message boundaries on read for \fISOCK_SEQPACKET\fR and
\fISOCK_RDM\fR sockets.  Message boundaries are never preserved for
\fISOCK_STREAM\fR sockets.

The following message flags to or returned from \fBrecv\fR(2),
\fBrecvfrom\fR(2) and \fBrecvmsg\fR(2) have special interpretations for
SCTP:
.RS
.TP
.B MSG_OOB
SCTP supports the return of the \fBMSG_OOB\fR flag from \fBrecv\fR(2),
\fBrecvfrom\fR(2) and \fBrecvmsg\fR(2).  Data read with the
\fBMSG_OOB\fR flag set indicates that the data was received on the
specified SCTP stream with the Unordered bit set.
.TP
.B MSG_EOR
For \fISOCK_SEQPACKET\fR sockets, the \fBMSG_EOR\fR flag indicates that
the data read has been read to the end of a record.  The \fBMSG_EOR\fR flag
is not used for \fISOCK_STREAM\fR or \fISOCK_RDM\fR SCTP sockets.
.TP
.B MSG_TRUNC
SCTP supports the use of the \fBMSG_TRUNC\fR flag to \fBrecv\fR(2),
\fBrecvfrom\fR(2) and \fBrecvmsg\fR(2).  Data read with the
\fBMSG_TRUNC\fR flag set will return the number of bytes available in the
packet rather than the number of bytes read.  When the \fBMSG_TRUNC\fR flag
is returned from \fBrecv\fR(2), \fBrecvfrom\fR(2) and \fBrecvmsg\fR(2),
it indicates that the record was truncated.  This latter behavior is only
valid for \fISOCK_RDM\fR sockets.  \fBMSG_TRUNC\fR is never set on return
for \fISOCK_STREAM\fR and \fISOCK_SEQPACKET\fR sockets.
.TP
.B MSG_ERRQUEUE
.RE
.IP
Other message flags have the same interpretation as described in
\fBrecv\fR(2), \fBrecvfrom\fR(2) and \fBrecvmsg\fR(2).
.TP
.BR write "(2), " send "(2), " sendto "(2) and " sendmsg "(2)"
SCTP preserves message boundaries on write for \fISOCK_SEQPACKET\fR and
\fISOCK_RDM\fR sockets.  Message boundaries are never preserved for
\fISOCK_STREAM\fR sockets.

The following message flags to \fBsend\fR(2), \fBsendto\fR(2) and
\fBsendmsg\fR(2) have special interpretations for SCTP:
.RS
.TP
.B MSG_OOB
SCTP supports the use of the \fBMSG_OOB\fR flag to \fBsend\fR(2),
\fBsendto\fR(2) and \fBsendmsg\fR(2).  Data written with the
\fBMSG_OOB\fR flag set indicates that the data is to be sent on the
specified SCTP stream with the Unordered bit set.
.TP
.B MSG_MORE
SCTP supports the use of the \fBMSG_MORE\fR flag to \fBsend\fR(2),
\fBsendto\fR(2) and \fBsendmsg\fR(2).  Data written with the
\fBMSG_MORE\fR flag set indicates that the data of a subsequent send
operation on the same stream contains additional data belonging to the same
record.  Use of the \fBMSG_MORE\fR flag is only supported for
\fISOCK_SEQPACKET\fR sockets.  Data written with \fBwrite\fR(2) is assumed
to contain an entire record.
.TP
.B MSG_PROBE
SCTP supports the use of the \fBMSG_PROBE\fR flag to
\fBsend\fR(2), \fBsendto\fR(2) and \fBsendmsg\fR(2).
Data written with the
\fBMSG_PROBE\fR flag set indicates that the data is to be used to fill out
the heartbeat data in a HEARTBEAT chunk and request that the SCTP send a
HEARTBEAT to the peer.  Use of the \fBMSG_PROBE\fR flag is supported on all
SCTP socket types.
.TP
.B MSG_EOF
SCTP supports the use of the \fBMSG_EOF\fR flags to 
\fBsend\fR(2), \fBsendto\fR(2) and \fBsendmsg\fR(2).
Data written with the \fBMSG_EOF\fR flag will be the last data sent on the
SCTP association and then a shutdown initiated.
.RE
.IP
Other message flags have the same interpretation as described in
\fBsend\fR(2), \fBsendto\fR(2) and \fBsendmsg\fR(2).
.TP
.BR shutdown "(2) and " close (2)
.SS "FEATURES"
.PP
Linux SCTP provides the added features described in this section:
.TP 3
\(bu
Standards support for socket type \fISOCK_SEQPACKET\fR.
.TP 3
\(bu
A \fBtcp\fR(7)-compatible mode for sockets of type \fISOCK_STREAM\fR.
.TP 3
\(bu
Supports a partial packet delivery interface on all packets.  \fIMSG_TRUNC\fR
set when receiving a packet does not discard the remainder of the packet but
permits subsequent reads to read the remainder of the packet.
.TP 3
\(bu
Silly Window Syndrome avoidance per RFC 1122 Section 4.2.3.2 and 4.2.3.3 as
recommended in the SCTP Implementor's Guide.
.TP 3
\(bu
Nagle algorithm per RFC 896 and RFC 1122 Section 4.2.3 with delayed ACK
modifications presented by Minshall in draft-minshall-tsvwg-nagle-01.txt.
.TP 3
\(bu
Message disposition and retrieval on connection shutdown or abort.
.TP 3
\(bu
Support for both Adler32 and CRC-32c checksums with autodetection of checksum
on receive.
.TP 3
\(bu
Support for multiple HMAC types.
.TP 3
\(bu
For security of HMACs, Linux SCTP includes a rekeying algorithm for secret
keys which rotates secret keys after the key's first cookie lifetime to
provide for maximum security for HMACs.
.TP 3
\(bu
Support for ADD-IP extensions.
.TP 3
\(bu
Support for PR-SCTP extensions.


.SH "SYSCTLS"
These sysctls can be accessed by the \fB/proc/sys/net/ipv4/*\fR files or
with the \fBsysctl\fR(2) interface.
.PP
In addition, 
all \fBsocket\fR(7) sysctls
.IR rmem_default ", " rmem_max ", " wmem_default ", " wmem_max ", " msg_cost ", " msg_burst ", " netdev_max_backlog " and " optmem_max
are supported by SCTP without modification.
\fBip\fR(7) sysctls
.IR ip_default_ttl ", " ip_dynaddr ", " ip_autoconfig ", " ip_local_port_range " and " ip_no_pmtu_disc
are supported by SCTP without modification;
.IR ip_forward ", " ipfrag_high_thresh ", " ipfrag_low_thresh " and " ip_always_defrag
sysctls are not applicable to SCTP.
For more information, see \fBsocket\fR(7) and \fBip\fR(7).
.PP
The following \fBsctp\fR(7) specific sysctls are supported by SCTP:
.TP
.B sctp_max_istreams
Defines the default maximum number of inbound SCTP streams that will be
requested when forming or receiving connections on an SCTP socket.  This is a
default value.  The actual value used by a socket for both ougoing and
incoming connections can be changed with the SCTP option
\fISCTP_ISTREAMS\fR before a call to \fBlisten\fR(2) or \fBconnect\fR(2).
.TP
.B sctp_req_ostreams
Defines the default requested number of outbound SCTP streams that will be
requested when forming or receiving connections on an SCTP socket.  This is a
default value.  The actual value used by a socket for both ougoing and
incoming connections can be changed with the SCTP option
\fISCTP_OSTREAMS\fR before a call to \fBlisten\fR(2) or \fBconnect\fR(2).
.TP
.B sctp_rto_initial
Defines the time interval (in milliseconds) which will be used as an initial
RTO (Retransmission Time Out) value when sending packets to a destination for
the first time.  Valid values are zero or greater and must be within the range
from \fIsctp_rto_min\fR to \fIsctp_rto_max\fR.  The default value is the
value recommended in RFC 2960 (3,000 milliseconds).  (Note: this is only a
default value which will be assigned to new destinations.  Each destination
can be controlled with the socket option \fISCTP_RTO\fR or
\fISCTP_RTO_INITIAL\fR described below under \fBSOCKET OPTIONS\fR.)
.TP
.B sctp_rto_min
Defines the time interval (in milliseconds) which will be used as a RTO
(Retransmission Time Out) value when sending packets.  Valid values must be
the number of milliseconds in a tick (1000/HZ) or greater and must be less
than or equal to the value of \fIsctp_rto_max\fR. The default value is the
value recommended in RFC 2960 (1,000 milliseconds).  (Note: this is only a
default value which will be assigned to new destinations.  Each destination
can be controlled with the socket option \fISCTP_RTO\fR or
\fISCTP_RTO_MIN\fR described below under \fBSOCKET OPTIONS\fR.)
.TP
.B sctp_rto_max
Defines the time interval (in milliseconds) which will be used as a RTO
(Retransmission Time Out) value when sending packets.  Valid values must be
the number of milliseconds in a tick (1000/HZ) or greater and must be greater
than or equal to the value of \fIsctp_rto_min\fR.  The default value is the
value recommended in RFC 2960 (60,000 milliseconds).  (Note: this is only a
default value which will be assigned to new destinations.  Each destination
can be controlled with the socket option \fISCTP_RTO\fR or
\fISCTP_RTO_MAX\fR described below under \fBSOCKET OPTIONS\fR.)
.TP
.B sctp_valid_cookie_life
Defines the time interval (in seconds) beyond which a COOKIE ECHO with a
cookie sent in an INIT ACK will no longer be accepted.  Valid values are 1
second or greater.  The default value is the value recommended in RFC 2960 (60
seconds).  The value for a given socket can be changed with the socket option
\fISCTP_COOKIE_LIFE\fR as described under \fBSOCKET OPTIONS\fR.
.TP
.B sctp_max_sack_delay
Defines the interval of time (in milliseconds) that the sending endpoint is
permitted to delay an acknowledgement of a received data chunk.  Valid values
are in the range from 1 to 500 milliseconds.  (RFC 2960 forbids setting this
value larger than 500 milliseconds.)  The default value is the value
recommended in RFC 2960 (200 milliseconds).  The value for a given socket can
be changed with the socket option \fISCTP_SACK_DELAY\fR as described under
\fBSOCKET OPTIONS\fR.
.TP
.B sctp_path_max_retrans
Defines the number of times that the sending SCTP endpoint will attempt
retransmitting a packet on to a given destination transport address before it
considers that destination transport address inactive.  Valid values include
zero.  The default value is the value recommended in RFC 2960 (5 retries).
(Note: this is only a default value which will be assigned to new
destinations.  Each destination can be controlled with the socket option
\fISCTP_RTO\fR or \fISCTP_PATH_MAX_RETRANS\fR described below under
\fBSOCKET OPTIONS\fR.)
.TP
.B sctp_assoc_max_retrans
Defines the number of times that the sending SCTP endpoint will attempt
retransmitting a packet on a given association before it aborts the
association.  Valid values include zero.  The default value is the value
recommended in RFC 2960 (10 retries).  This value should be larger than the
sum of all of the \fIpath_max_retrans\fR values of each of the destinations.
The value for a given socket can be changed with the socket option
\fISCTP_ASSOC_MAX_RETRANS\fR as described under \fBSOCKET OPTIONS\fR.
.TP
.B sctp_max_init_retries
The number of times that an SCTP INIT or COOKIE ECHO will be resent before
abandoning the association intialization.  Valid values include zero.  The
default value is the value recommended in RFC 2960 (8 retries).
The value for a given socket can be changed with the socket option
\fISCTP_MAX_INIT_RETRIES\fR as described under \fBSOCKET OPTIONS\fR.
.TP
.B sctp_heartbeat_itvl
Defines the interval (in seconds) between successive HEARTBEAT messages used
to probe destination transport address for RTT calculation and activity.
Valid valids are 1 second or greater.  The default value is the value
recommended in RFC 2960 (30 seconds).  (Note: This is only the default value
which will be assigned to new destinations.  Each destination can be
controlled with the socket option \fISCTP_HB\fR or
\fISCTP_HEARTBEAT_ITVL\fR described below under \fBSOCKET OPTIONS\fR.)

If the kernel configuration parameter \fICONFIG_SCTP_THROTTLE_HEARTBEATS\fR
is set, then half this value is also used for throttling heartbeats.  Then
only two heartbeats per interval are permitted, any additional heartbeats are
discarded.
.TP
.B sctp_mac_type
Defines the MAC (Message Authentication Code) type which will be used when
signing cookies in INIT ACK messages.  Valid values are
\fISCTP_HMAC_SHA_1\fR, for the FIPS 180-1 Secure Hash Algorithm SHA-1 HMAC,
\fISCTP_HMAC_MD5\fR, for the RFC 1321 Message Digest 5 HMAC, and
\fISCTP_HMAC_NONE\fR, for no secure signature.  There is no required value
here for RFC 2960.  The default value is (in priority of availability)
\fISCTP_HMAC_MD5\fR, \fISCTP_HMAC_SHA_1\fR, then \fISCTP_HMAC_NONE\fR.
SHA-1 performs well on big-endian machines, MD5 performs well on little-endian
machines.  Whether either of these can be selected depends on the kernel
configuration parameters \fICONFIG_SCTP_HMAC_SHA1\fR and
\fICONFIG_SCTP_HMAC_MD5\fR.  The MAC for a given socket can be changed
before the \fBlisten\fR(2) call with the socket option \fISCTP_MAC_TYPE\fR
as described under \fBSOCKET OPTIONS\fR.
.TP
.B sctp_cookie_inc
Defines the time increment (in milliseconds) which will be added to the
lifespan of the cookie in an INIT ACK if the received INIT requests cookie
preservative to lengthen the lifespan of the cookie.  Valid values include
zero.  The default value is the value recommended in RFC 2960 5.2.6 (1
second).  The cookie lifetime increment for a given socket can be changed
before the \fBlisten\fR(2) call with the socket option
\fISCTP_COOKIE_INC\fR as described under \fBSOCKET OPTIONS\fR.
.TP
.B sctp_throttle_itvl
Defines the interval (in milliseconds) within which the SCTP receiver will not
accept more than one INIT or COOKIE ECHO.  Zero (don't throttle) is a valid
value.  The default value is 50 milliseconds.  When the HMAC type is SHA-1 or
MD5, the implementation is vulnerable to DoS flood attacks using INIT or
COOKIE ECHO messages.  When SCTP is compiled with
\fICONFIG_SCTP_THROTTLE_PASSIVEOPENS\fR, this permits the throttling of INIT
and COOKIE ECHO messages.  Only one INIT and one COOKIE ECHO message will be
accepted in the interval set by this control.  The throttle interval for a
given socket can be changed before the \fBlisten\fR(2) call with the socket
option \fISCTP_THROTTLE_ITVL\fR as described under \fBSOCKET OPTIONS\fR.
.TP
.B sctp_checksum_algorithm
Defines the checksum algorithm which will be used when checksumming packets.
Valie values are \fISCTP_CSUM_ADLER_32\fR for the RFC 2960 Appendix B
algorithm and \fISCTP_CSUM_CRC_32C\fR for the
draft-ietf-tsvwg-sctpcsum-06.txt CRC-32C checksum algorithm.  This value may
also be set for a given socket using the \fISCTP_CKSUM_TYPE\fR socket option
described below.
.TP
.B sctp_wmem
Defines three values (lower, default, upper) for the socket write buffer.  The
value associated with a given socket can also be changed with the
\fISO_SNDBUF\fR option, see \fBsocket\fR(7).
.TP
.B sctp_rmem
Defines three values (lower, default, upper) for the socket read buffer.  The
value associated with a given socket can also be changed with the
\fISO_RCVBUF\fR option, see \fBsocket\fR(7).
.SH "SOCKET_OPTIONS"
To set or get a SCTP socket option, call \fBgetsockopt\fR(2) to read or
\fBsetsockopt\fR(2) to write the option with the socket family argument set
to \fBSOL_SCTP\fR.  In addition, most \fBSOL_SOCKET\fR and \fBSOL_IP\fR
socket options are valid on SCTP sockets.  For more information see
\fBsocket\fR(7) and \fBip\fR(7).
.PP
The following \fISOL_SOCKET\fR \fBsocket\fR(7) socket options are supported:
.TP
.B SO_KEEPALIVE
Sets or gets a flag that controls heartbeats for the entire SCTP association.
See \fBsocket\fR(7) for additional information.
.IP
Normally SCTP is required to send HEARTBEAT chunks on a per-destination basis.
Clearing this flag (setting \fISO_KEEPALIVE\fR to zero) disables
heartbeating on an association level.  Heartbeating is an essential part of
the Stream Control Transmission Protocol (SCTP).  It is required for clearing
retransmission counts against destinations that otherwise will not be cleared
if no data is sent and acknowledged to that destination.  Disabling heartbeats
is provided for in the SCTP specifications (RFC 2960); however,
disabling heartbeats is not recommended.  This is in contrast to
\fBtcp\fR(7) which only rarely heartbeats and for which heartbeats are
neither an essential nor necessary part of the protocol.
.IP
Heartbeats can alos be enabled or disable on a per-destination basis using the
\fISCTP_HB\fR socket option.
.TP
.B SO_OOBINLINE
If this option is enabled, out of order data which has been received on a
stream will be placed between the ordered data for that stream.  Otherwise,
out of order data is only returned on a read call when the \fBMSG_OOB\fR
flag is set when receiving.  This option is ignored for \fISOCK_RDM\fR
sockets and only applies to \fISOCK_STREAM\fR and \fISOCK_SEQPACKET\fR
SCTP sockets.
See \fBsocket\fR(7) for additional information.
.TP
.B SO_BINDTODEVICE
Binds the socket to a particular device.  This is not yet supported for
LinuxSCTP; however, support for it is planned for the future.
See \fBsocket\fR(7) for additional information.
.TP
.B SO_REUSEADDR
Supported by SCTP without modification; however, consideration is made for
binding of multiple transport addresses.
See \fBsocket\fR(7) for additional information.
.TP
.BR SO_RCVLOWAT ", " SO_SNDLOWAT ", " SO_RCVTIMEO ", " SO_SNDTIMEO ", " SO_DEBUG ", " SO_TYPE ", " SO_DONTROUTE ", " SO_SNDBUF ", " SO_RCVBUF ", " SO_LINGER ", " SO_PRIORITY " and " SO_ERROR
These socket options are supported by SCTP without modification.
See \fBsocket\fR(7) for additional information.
.PP
The following \fISOL_IP\fR \fBip\fR(7) socket options are supported:
.TP
.B IP_OPTIONS
Sets or gets the IP options to be sent with every packet from this socket.
See \fBip\fR(7) for additional information.
.TP
.B IP_PKTINFO
Pass an \fIIP_PKINFO\fR ancilliary message that contains the \fBpktinfo\fR
structure that supplies some information about the incoming or outgoing
packet.  This only works for \fISOCK_SEQPACKET\fR and \fISOCK_RDM\fR
sockets.  It is ignored for TCP-compatible \fISOCK_STREAM\fR sockets.
For \fBsetsockopt\fR(2)
and \fBgetsockopt\fR(2), the argument is a flag that tells the socket wither
the \fIIP_PKTINFO\fR message should be passed or not.  The message itself
can only be sent or retrieved as a control message with a packet using
\fBrecvmsg\fR(2) or \fBsendmsg\fR(2).

.nf
.ps -1
\fC\
struct in_pktinfo {
        unsigned int    ipi_ifindex;    /* Interface index      */
        struct in_addr  ipi_spec_dst;   /* Local address        */
        struct in_addr  ipi_addr;       /* Header Dest Address  */
};
.ps +1
.fi

.RS
.TP
.I ipi_ifindex
is the unique index of the interface the packet was received on, or the index
of the interface upon which the packet is to be sent;
.TP
.I ipi_spec_dst
is the local address of the received packet or sent packet, and
.TP
.I ipi_addr
is the destination address in the packet header.
.RE
.IP
If \fIIP_PKTINFO\fR is passed to \fBsendmsg\fR(2) then the outgoing packet
will be sent over the interface specified in \fIipi_ifindex\fR with the
destination address set to \fIipi_spec_dst\fR.

This option is used under SCTP to control the source (local) address of
packets sent with \fBsendmsg\fR(2) and to retrieve the destination (local)
address of packets received with \fBrecvmsg\fR(2).
See \fBip\fR(7) for additional information.

Support under \fBsctp\fR(7) for \fIIP_PKTINFO\fR is similar to support for
this socket option under \fBudp\fR(7).  Under \fBudp\fR(7),
\fIIP_PKTINFO\fR is used for multi-homed UDP hosts to specify the local
address to \fBsendmsg\fR(2) and return remote address from
\fBrecvmsg\fR(2).  SCTP uses this in a similar fashion where the choice of
addresses consists of the address space of the association.
.TP
.B IP_RECVTOS
Sets or gets the flag indicating whether the \fBrecvmsg\fR(2) call will
return the type of service field for the received packet in an ancilliary
message as a \fIIP_TOS\fR control message for SCTP sockets of type
\fISOCK_SEQPACKET\fR and \fISOCK_RDM\fR.
This option is ignored for TCP-compatible \fISOCK_STREAM\fR sockets.
See \fBip\fR(7) for additional information.
.TP
.B IP_RECVTTL
Sets or gets the flag indicating whether the \fBrecvmsg\fR(2) call will
return the time to live field for the received packet an ancilliary
message as a \fIIP_TTL\fR control message for SCTP sockets of type
\fISOCK_SEQPACKET\fR and \fISOCK_RDM\fR.
This option is ignored for TCP-compatible \fISOCK_STREAM\fR sockets.
See \fBip\fR(7) for additional information.
.TP
.B IP_RECVOPTS
Sets or gets the flag indicating whether the \fBrecvmsg\fR(2) call will
return the IP options for the received packet in an ancilliary message as an
\fIIP_OPTIONS\fR control message for SCTP sockets of type
\fISOCK_SEQPACKET\fR and \fISOCK_RDM\fR.
This option is ignored for TCP-compatible \fISOCK_STREAM\fR sockets.
See \fBip\fR(7) for additional information.
.TP
.B IP_RETOPTS
Sets or gets the flag indicationg whether the \fBrecvmsg\fR(2) call will
return the IP options for the received packet in an ancilliary message as an
\fIIP_RETOPTS\fR control message for SCTP sockets of type
\fISOCK_SEQPACKET\fR and \fISOCK_RDM\fR.
This option is ignored for TCP-compatible \fISOCK_STREAM\fR sockets.
See \fBip\fR(7) for additional information.

In contrast to \fIIP_OPTIONS\fR, the \fIIP_RETOPTS\fR ancilliary message
contains raw, unprocessed options, with the timestamp and route record options
not filled in for this hop.  It is also possible to pass an \fIIP_RETOPTS\fR
ancilliary message to \fBsendmsg\fR(2).
.TP
.B IP_TOS
Sets or gets the default type of service to be used in IP packets associated
with the connection.  For \fISOCK_SEQPACKET\fR and \fISOCK_RDM\fR SCTP
sockets, this option can also be passed to \fBsendmsg\fR(2) in the
ancilliary data and will be used as the type of service field in the IP packet
containing the data chunk associated with the user data provided in the call
to \fBsendmsg\fR(2).  For \fISOCK_SEQPACKET\fR and \fISOCK_RDM\fR SCTP
sockets, this option returns the type of service parameter associated with a
packet in the ancilliary data returned from a call to \fBrecvmsg\fR(2) when
the \fBIP_RECVTOS\fR option has been set on the socket.
This option is ignored for TCP-compatible \fISOCK_STREAM\fR sockets.
See \fBip\fR(7) for additional information.
.TP
.B IP_TTL
Sets or gets the default time to live to be used in IP packets associated with
the connection.  This option can also be passed to \fBsendmsg\fR(2) in the
ancilliary data and will be used as the time to live field in the IP packet
containing the data chunk associated with the user data provided in the call
to \fBsendmsg\fR(2).
See \fBip\fR(7) for additional information.
.TP
.B IP_MTU
For SCTP sockets, this returns only the Path MTU for the association.  This
value is the minimum MTU of all the peer destinations.
See SCTP socket options for a mechanism for obtaining MTU on a per-destination
basis.
When the peer is not multi-homed, this option returns the same value as would
be obtained on a per-destination basis.
See \fBip\fR(7) for additional information.
.TP
.BR IP_RECVERR " and " IP_PMTU_DISCOVER
Supported for SCTP sockets without modification.
See \fBip\fR(7) for additional information.
.PP
The following \fISOL_SCTP\fR \fBsctp\fR(7) socket options are supported:
.TP
.B SCTP_NODELAY
Turn the Nagle algorithm off.  This means that packets are always sent as soon
as possible and no unnecessary delays are introduced, at the cost of more
packets in the network.  Expects an integer boolean flag.

This parallels the \fITCP_NODELAY\fR socket option for compatibility with
\fBtcp\fR(7).  \fISCTP_NODELAY\fR and \fITCP_NODELAY\fR can be used
interchangeably.  For \fISOCK_STREAM\fR sockets, this setting applies to the
default stream as set the \fISCTP_SID\fR socket option.  For regular
\fISOCK_SEQPACKET\fR sockets, this setting applies to the entire
association.  For TCP-compatible \fISOCK_STREAM\fR sockets, this setting has
the same effect as \fBtcp\fR(7).  This option has no effect on
\fISOCK_RDM\fR sockets.  See \fBtcp\fR(7) for additional information.

When Nagle is enabled, \fBsctp\fR(7) uses the Nagle algorithm (RFC 896) for
bundling DATA chunks into an SCTP packet.  This results in far fewer short
SCTP packets in the network.  The algorithm is that described in RFC 896 and
RFC 1122 with the Minshall modifications to accomodate delayed SACK as
described in draft-minshall-nagle-01.txt.  (Note: later versions of
\fBtcp\fR(7) also in include the Minshall modification).
.TP
.B SCTP_MAXSEG
Set or get the maximum segment size for outgoing packets.  Values
greater than the association MTU are ignored and have no effect.

This parallels the \fITCP_MAXSEG\fR socket option for compatibility with
\fBtcp\fR(7).  \fISCTP_MAXSEG\fR and \fITCP_MAXSEG\fR can be used
interchangeably.  This option is only applicable to \fISOCK_SEQPACKET\fR and
TCP-compatible \fISOCK_STREAM\fR sockets.

This value determines the maximum size (in bytes) above which SCTP will
fragment larger DATA chunks into smaller DATA chunks, and beneath which SCTP
will bundle DATA chunks into a single packet or combine smaller DATA chunks
into larger DATA chunks.  Normally this value is the association MTU value
minus the size of the current IP and SCTP headers, minus the size of one DATA
chunk header.  If the user sets this to a lower value, the lower value will be
used.
.TP
.B SCTP_CORK
If enabled don't send out partial frames.  All queued partial frames are sent
when the option is cleared again.  This is useful for prepending headers
before calling \fBsendfile\fR(2), or for throughput optimization.  This
option cannot be combined with \fISCTP_NODELAY\fR.

This parallels the \fITCP_CORK\fR socket option for compatibility with
\fBtcp\fR(7).  \fISCTP_CORK\fR and \fITCP_CORK\fR can be used
interchangeably.  For \fISOCK_STREAM\fR sockets, this setting applies to the
default stream as set by the \fISCTP_SIB\fR socket option.  For regular
\fISOCK_SEQPACKET\fR sockets, this setting applies to the entire
association.  This option has no effect on \fISOCK_RDM\fR sockets.
.TP
.B SCTP_SID
Sets or gets the default stream identifier for all outgoing packets associated
with the connection.  If \fISCTP_SID\fR is passed to \fBsendmsg\fR(2) then
the outgoing packet will be sent over the stream specified by the integer
stream identifier contained in the ancillary message.   If \fISCTP_SID\fR is
received from a call to \fBrecvmsg\fR(2) then the incoming packet was
received over the stream specified by the integer stream identifier contained
in the ancilliary message.  See also \fISCTP_RECVSID\fR.
.TP
.B SCTP_PPI
Set or get the payload protocol identifier for all outgoing packets.  If
\fISCTP_PPI\fR is passed to \fBsendmsg(\fR(2) then the outgoing packet
will be sent with the payload protocol identifier specified by the integer
payload protocol identifier contains in the ancillary message.  If
\fISCTP_PPI\fR is received from a call to \fBrecvmsg\fR(2) then the
incoming packet was received with the payload protocol identifier specified in
by the integer payload protocol identifier contained in the ancilliary
message.  See also \fISCTP_RECVPPI\fR.
.TP
.B SCTP_RECVSID
When this flag is set pass a \fISCTP_SID\fR control message with the stream
identifier for received packets as an integer in an ancillary message which
may be received with \fBrecvmsg\fR(2).
.TP
.B SCTP_RECVPPI
When this flag is set pass a \fISCTP_PPI\fR control message with the payload
protocol identifier for received packets as an integer in an ancillary message
which may be received with \fBrecvmsg\fR(2).
.TP
.B SCTP_HB
Set or get the heartbeat activation and interval associated with the
specified destination address. The expected value is a \fBsctp_hbitvl\fR
structure.
This option will return an error if it is attempted on a socket in the unconnected state.

.RS
.nf
.ps -1
\fC\
    struct sctp_hbitvl {
        struct sockaddr_in
              dest;   /* destination address      */
        uint  active; /* activation flag          */
        uint  itvl;   /* interval in milliseconds */
    };
.ps +1
.fi
.TP
\fIdest\fR
is a \fBsockaddr_in\fR structure which contains the destination
address to which the heartbeat setting applies.
.TP
\fIactive\fR
is an integer boolean activation flag indicating whether heartbeat is active
on the destination.
.TP
\fIitvl\fR
is the integer heartbeat interval in milliseconds.
.RE
.IP
For use with \fBsetsockopt\fR(2),
\fIdest\fR must be one of the valid destination addresses associated with
the connection: that is, it must be one of the addresses returned from a call
to \fBgetpeername\fR(2).
Note that heartbeat activity and interval can also be set on an association
basis with \fISO_KEEPALIVE\fR and \fISCTP_HEARTBEAT_ITVL\fR.
.TP
.B SCTP_RTO
Set or get the retransmission timeout parameters associated with the
specified desination address.  The expected value is a \fBsctp_rtoval\fR
structure.
This option will return an error if it is attempted on a socket in the unconnected state.

.RS
.nf
.ps -1
\fC\
    struct sctp_rtoval {
        struct sockaddr_in
              dest;        /* destination address        */
        uint  rto_initial; /* RTO.Initial (milliseconds) */
        uint  rto_min;     /* RTO.Min     (milliseconds) */
        uint  rto_max;     /* RTO.Max     (milliseconds) */
        uint  max_retrans; /* Path.Max.Retrans (retries) */
    };
.ps +1
.fi
.TP
\fIdest\fR
is a \fBsockaddr_in\fR structure which contains the destination address to
which the rto parameter setting applies.
.TP
\fIrto_initial\fR
is the integer initial retransmission timeout value in milliseconds.
For expected values see \fISCTP_RTO_INITIAL\fR.
.TP
\fIrto_min\fR
is the integer minimum retransmission timeout value in milliseconds.
For expected values see \fISCTP_RTO_MIN\fR.
.TP
\fIrto_max\fR
is the integer maximum retransmission timeout value in milliseconds.
For expected values see \fISCTP_RTO_MAX\fR.
.TP
\fImax_retrans\fR
is the integer maximum number of retransmissions.
For expected values see \fISCTP_PATH_MAX_RETRANS\fR.
.RE
.IP
For use with \fBsetsockopt\fR(2),
\fIdest\fR must be one of the valid destination addresses associated with
the connection: that is, it must be one of the addresses returned from a call
to \fBgetpeername\fR(2).
.TP
.B SCTP_COOKIE_LIFE
Sets or gets the cookie lifetime associated with a socket.  This is the amount
of time that cookies sent to a peer endpoint in an INIT-ACK message will be
valid.  For Linux SCTP this also limits the maximum for which the HMAC secret
key for the cookie will be valid.  The value is a integer time interval in
milliseconds.  Valid values are from 0 to MAXINT.  The default value is set by
the sysctl \fIsctp_cookie_life\fR.  This socket option must be set before
the call to \fBlisten\fR(2).
.TP
.B SCTP_SACK_DELAY
Sets or gets the maximum SACK delay as the interval of time (in milliseconds)
that the sending enpoint will delay an acknowledgement of a received data
chunk.  Valid values are in the range from 0 to MAXINT, however, the value of
the maximum SACK delay should not exceed the maximum RTO as set by
\fISCTP_RTO_MAX\fR.  The default value is set by the sysctl
\fIsctp_sack_delay\fR.  socket option may be set at any time during the life
of the socket.
.TP
.B SCTP_PATH_MAX_RETRANS
Sets or gets the number of times that the sending SCTP endpoint will attempt
retransmitting a packet to a given destination transport address before it
consideres that desstination transport address inactive.  Valid values include
zero.  The default values is set by the sysctl \fIsctp_path_max_retrans\fR.
This is the default value assigned to destinations before the call to
\fBlisten\fR(2) or \fBconnect\fR(2).  Active destinations can be
controlled with the \fBSCTP_RTO\fR socket option.
.TP
.B SCTP_ASSOC_MAX_RETRANS
Sets or gets the number of times that the sending SCTP endpoint will attempt
retransmitting a packet on a given association before it aborts the
association.  Valid values include zero.  The default value is set by the
sysctl \fIsctp_assoc_max_retrans\fR.  This valie should be larger than the
sumof all the \fISCTP_PATH_MAX_RETRANS\fR values of each of the
destinations.  This value can be changed on an idle or active association
(connection) using this socket option.
.TP
.B SCTP_MAX_INIT_RETRIES
Sets or gets the number of times that an SCTP INIT or COOKIE ECHO will be
resent before abandoning the association initialization.  Valid values include
zero.  The default value is set by the sysctl \fIsctp_max_init_retries\fR.
This socket option must be set before the call to \fBlisten\fR(2) or
\fBconnect\fR(2).
.TP
.B SCTP_HEARTBEAT_ITVL
Sets or gets the interval (in seconds) between successive HEARTBEAT messages
use to probe destination transport addresses for RTT calculation and activity.
Valid valis are 1 second or greater.  The default value is set by the sysctl
\fIsctp_heartbeat_itvl\fR.  This is the default value which will be assigned
to new destinations.  Active destinations can be controlled with the socket
option \fISCTP_HB\fR.  This socket option must be set before the call to
\fBlisten\fR(2) or \fBconnect\fR(2).
.TP
.B SCTP_RTO_INITIAL
Sets or gets the time interval (in milliseconds) which will be used as an
initial RTO (Retransmission Time Out) value when sending packets to a
destination for the first time.  Value values are zero or greater and must be
within the range from \fISCTP_RTO_MIN\fR to \fISCTP_RTO_MAX\fR.  The
default value is the value set by \fIsctp_rto_initial\fR.  This socket
option must be set before the call to \fBlisten\fR(2) or \fBconnect\fR(2),
but the value may be controlled on active destination with the
\fISCTP_RTO\fR socket option.
.TP
.B SCTP_RTO_MIN
Sets of gest the time interval (in milliseconds) which will be used as a
minimum RTO (Retransmission Time Out) value when sending packets.  Valid
values are zero or greater and must be less than or equal to the value of
\fISCTP_RTO_MAX\fR.  The default value is set by the sysctl
\fIsctp_rto_min\fR.  This socket option must be set before the call to
\fBlisten\fR(2) or \fBconnect\fR(2), but the value associated with active
destinations can be controlled using the \fISCTP_RTO\fR socket option.
.TP
.B SCTP_RTO_MAX
Sets of gest the time interval (in milliseconds) which will be used as a
maximum RTO (Retransmission Time Out) value when sending packets.  Valid
values are zero or greater and must be greater than or equal to the value of
\fISCTP_RTO_MIN\fR.  The default value is set by the sysctl
\fIsctp_rto_max\fR.  This socket option must be set before the call to
\fBlisten\fR(2) or \fBconnect\fR(2), but the value associated with active
destinations can be controlled using the \fISCTP_RTO\fR socket option.
.TP
.B SCTP_OSTREAMS
Sets the number of requested outbound streams or gets the actual number of
outbound streams associated with a connection.  Valid values are from 1 to
16,736.  The default value is set by the sysctl \fIsctp_req_ostreams\fR.
This socket option must be set before or after the call to \fBlisten\fR(2)
or \fBconnect\fR(2) but can be read at any time.
For \fBtcp\fR(7)-compatible \fISOCK_STREAM\fR sockets, the number of outbound
streams is fixed at one (1) and this socket option has no effect.
.TP
.B SCTP_ISTREAMS
Sets the maximum number inbound streams or gets the actual number of inbound
streams associated with a connection.  Valid values are from 1 to 16,736.  The
default value is set by the sysctl \fIsctp_max_istreams\fR.  This socket
option must be set before or after the call to \fBlisten\fR(2) or
\fBconnect\fR(2) but can be read at any time.
For \fBtcp\fR(7)-compatible \fISOCK_STREAM\fR sockets, the number of inbound
streams is fixed at one (1) and this socket option has no effect.
.TP
.B SCTP_COOKIE_INC
Sets or gets the time increment (in milliseconds) which will be added to the
lifespan of the cookie in an INIT ACK if the receive INIT request cookie
preservation to lengthen the lifespan of the cookie.  Valid values include
zero.  The default value is set by the sysctl \fIsctp_cookie_inc\fR.  This
socket option must be set before or after the call to \fBlisten\fR(2) but
can be read at any time.
.TP
.B SCTP_THROTTLE_ITVL
Sets or gets the interval (in milliseconds) within which the SCTP receive will
not accept more than one INIT or COOKIE ECHO.  Zero (don't throttle) is a
valid value.  The default is set by the sysctl \fIsctp_throttle_itvl\fR.
This socket option must be set before or after the call to \fBlisten\fR(2).
.TP
.B SCTP_MAC_TYPE
Sets or gets the MAC (Message Authentication Code) type which will be used
when signing cookies in INIT ACK messages.  Valid values are
\fISCTP_HMAC_SHA_1\fR, \fISCTP_HMAC_MD5\fR, and \fISCTP_HMAC_NONE\fR.
The default value is set by the sysctl \fIsctp_mac_type\fR.  This socket
option must be set before or after the call to \fBlisten\fR(2).
.TP
.B SCTP_CKSUM_TYPE
Sets or gets the checksum algorithm associated with socket.  Valid values are
\fISCTP_CSUM_ADLER_32\fR and \fISCTP_CSUM_CRC_32C\fR.  The default value
is set by the sysctl \fIsctp_csum_algorithm\fR.  This socket option must be
set before the call to \fBlisten\fR(2) or \fBconnect\fR(2).
.TP
.B SCTP_DEBUG_OPTIONS
(tbd)
.TP
.B SCTP_STATUS
Gets the association status and the status associated with each of the
destination transport addresses forming the association.  The returned value
is a \fBsctp_astat\fR structure following by \fIassoc_nrep\fR
\fBsctp_dstat\fR structures (one for each destination transport address as
returned by \fBgetpeername\fR(2)).

.RS
.nf
.ps -1
\fC\
    struct sctp_astat {
        uint assoc_rwnd;  /* receive window           */
        uint assoc_rbuf;  /* receive buffer           */
        uint assoc_nrep;  /* destinations reported    */
    };

    struct sctp_dstat {
        struct sockaddr_in
              dest;       /* destination address      */
        uint dst_cwnd;    /* congestion window        */
        uint dst_unack;   /* unacknowledged chunks    */
        uint dst_srtt;    /* smoothed round trip time */
        uint dst_rvar;    /* rtt variance             */
        uint dst_rto;     /* current rto              */
        uint dst_sst;     /* slow start threshold     */
    };
.ps +1
.fi
.TP
.I assoc_rwnd
is the current advertized receive window in bytes.
.TP
.I assoc_rbuf
is the current receive buffer size in bytes.
.TP
.I assoc_nrep
is the number of \fBsctp_dstat\fR structures that follow this structure.
.TP
.I dest
is the address associated with this \fBsctp_dstat\fR structure.
.TP
.I dst_cwnd
is the congestion window for the given destination transport address in bytes.
.TP
.I dst_unack
is the number of unacknowledged DATA chunks outstanding to the given
destination transport address in chunks.
.TP
.I dst_srtt
is the current smoothed round trip time for the destination transport address
in milliseconds.
.TP
.I dst_rvar
is the RTT variance for the destination transport address in milliseconds.
.TP
.I dst_rto
is the current value of the RTO for the destination transport address in
milliseconds.
.TP
.I dst_sst
is the current value of the slow start threshold in bytes.
.RE
.TP
.B SCTP_DISPOSITION
Gets or sets a flag which determines whether SCTP will retain and deliver
messages that we not successfully acknowledged by the peer for retrieval.
Expects an integer value \fISCTP_DISPOSITION_NONE\fR,
\fISCTP_DISPOSITION_UNSENT\fR or \fISCTP_DISPOSITION_SENT\fR.

When this flag is set to \fISCTP_DISPOSITION_NONE\fR, messages will not be
retained for retrieval.  When set to \fISCTP_DISPOSITION_SENT\fR, SCTP will
retain and provide for retrieval all messages that were sent and
unacknowledged, or which were unsent at the time that the connection shut down
or aborted.  When set to \fISCTP_DISPOSITION_UNSENT\fR, SCTP will retain and
provide for retrieval only messages that were unsent.

If \fISCTP_DISPOSITION\fR is received from a call to \fBrecvmsg\fR(2) then the
read packet represents a packet which was held for retrieval.  When
\fISCTP_DISPOSITION\fR is set to \fISCTP_DISPOSITION_UNSENT\fR in the
ancilliary message, the read data represents a packet which was unsent at the
time that the connection shut down or aborted.  If set to
\fISCTP_DISPOSITION_SENT\fR, then the read data was a packet that was sent but
not acknowledged (with a cummulative ack) before the connection was shut down
or aborted.

This option permits message which are unsent or sent but not acknowledged to
be retrieved from the socket before close.  This is accmoplished by setting
the \fISCTP_DISPOSITION\fR socket option prior to shutdown or abort, and then
calling \fBrecvmsg\fR(2) after POLLHUP, SIGPIPE or EPIPE indicating shutdown
or abort of the connection.  Messages read in this fashion will have the
\fISCTP_DISPOSITION\fR(2) ancilliary message attached and will indicate
whether they were \fISCTP_DISPOSITION_SENT\fR or
\fISCTP_DISPOSITION_UNSENT\fR.
.TP
.B SCTP_ADD_IP
When set, requests that the provided IP address(es) (\fIaddrs\fR), provided in
an array of \fBsockaddr_in\fR structures be added to the local IP addresses
associated with the connection.  If the socket is in a connected or connecting
state, this invokes the ASCONF procedure to add the IP addresses to the
association.  If the socket is in a disconnected state, this adds the
specified IP addresses to the address list bound with \fBbind\fR(2).  If the
socket is unbound, this option has the same effect as \fBbind\fR(2).

If the socket was initially bound to \fIINADDR_ANY\fR, additional IP addresses
may be automatically bound to the socket if new network interfaces are added
to the system, or if existing network interfaces are configured with
\fBifconfig\fR(8) or equivalent commands.
.TP
.B SCTP_DEL_IP
When set, requests that the provided IP address(es) (\fIaddrs\fR), provided in
an array of \fBsockaddr_in\fR structures be removed from the list of local IP
addresses associated with the connection.  If the socket is in a conencted
state, this invokes the ASCONF procedures to delete the IP address from the
association.  If the socket is in a disconnected state, this removes the
specified IP address from the address list bound with \fBbind\fR(2).
\fIaddrs\fR must be a list addresses belonging to the set of the addresses
returned by \fBgetsockname\fR(2).  If the addresses are the only adddress
remaining in the local address list, this call will fail (\fIEINVAL\fR) if the
socket is connected, and will have the same effect as binding to
\fIAF_UNSPEC\fR with \fBbind\fR(2) if the socket is disconnected.

If the socket was initially bound to \fIINADDR_ANY\fR, IP addresses
may be automatically unbound from the socket if network interfaces are
removed from the system, or if network interfaces are reconfigured with
\fBifconfig\fR(8) or equivalent commands.
.TP
.B SCTP_PR_STREAMS

.SH "IOCTLS"
These ioctls can be accessed using \fBioctl\fR(2).  The correct syntax is:
.PP
.RS
.nf
.BI int " value" ;
.IB error " = ioctl(" sctp_socket ", " ioctl_type ", &" value ");"
.fi
.RE
.PP
All \fBsocket\fR(7) ioctls are supported by SCTP without
modification:
.IR SIOCGSTAMP ", " SIOCSPGRP ", " FIOASYNC " and " SIOCGPGRP .
All \fBsocket\fR(7) fcntls are supported by SCTP:
.IR FIOCGETOWN " and " FIOCSETOWN ,
.PP
The following \fBtcp\fR(7) ioctls are supported by SCTP:
.TP
.B SIOCINQ
Returns the amount of queued unread data in the receive buffer.  Argument is a
pointer to an integer.
.TP
.B SIOCATMARK
Returns true when all urgent data has already been received by the user
program.  This is used together with \fBSO_OOBINLINE\fR.  Argument is a
pointer to an integer for the test result.
.TP
.B SIOCOUTQ
Returns the amount of unsent data in the socket send queue in the passed
integer value pointer.
.SH "ERROR HANDLING"
When a network error occurs, SCTP tries to resend the packet.  If it doesn't
succeed after some time, either \fBETIMEDOUT\fR or the last received error
on this connection is reported.
.PP
Some applications require a quicker error notification.  This can be enabled
with the \fBSOL_IP\fR level \fBIP_RECVERR\fR socket option.  When this
option is enabled, all incoming errors are immediately passed to the user
program.  Use this option with care \- it makes SCTP less tolerant to routing
changes and other normal network conditions.
.SH "NOTES"
When an error occurs doing a connection setup occuring in a socket write
\fBSIGPIPE\fR is only raised when the \fBSO_KEEPOPEN\fR socket option is
set.

SCTP has no real out-of-band or urgent data; it has out-of-order data.  In
Linux this means if the other end sends newer out-of-band data the older
urgent data may arrive later.

If the socket option \fBSO_KEEPALIVE\fR is not set (see \fBsocket\fR(7)),
SCTP will not generate heartbeats to any destination.  For regular
\fBSOCK_SEQPACKET\fR and \fBSOCK_RDM\fR SCTP sockets, \fBSO_KEEPALIVE\fR
defaults to set.  For \fBtcp\fR(7)-compatible \fBSOCK_STREAM\fR SCTP
sockets, \fBSO_KEEPALIVE\fR defaults to unset.
.SH "ERRORS"
.TP
.B EPIPE
The other end closed the socket unexpectedly or a read is executed on a shut
down socket.
.TP
.B ETIMEDOUT
The other end didn't acknowledge retransmitted data after some time.
.TP
.B EAFNOTSUPPORT
Passed socket address type in \fIsin_family\fR was not \fBAF_INET\fR.
.PP
Any errors defined for \fBip\fR(7) or the generic \fBsocket\fR(7) layer
may also be returned for SCTP.
.PP

.SH "CAVEATS"
.PP
Linux SCTP does not currently support IPv6.
.PP
SCTP host name addresses are not supported.
.SH "BUGS"
Not all errors are documented.
.PP
IPv6 is not described.
.PP
Transparent proxy options are not described.
.SH "AUTHOR"
.SH "VERSIONS"
This interface was new in Linux 2.2.
.B IP_RECVERR
is a new feature in Linux 2.2.
.B SCTP_CORK
is new in 2.2.
The socket options
.BR SCTP_COOKIE_LIFE ,
.BR SCTP_SACK_DELAY ,
.BR SCTP_PATH_MAX_RETRANS ,
.BR SCTP_ASSOC_MAX_RETRANS ,
.BR SCTP_MAX_INIT_RETRIES ,
.BR SCTP_HEARTBEAT_ITVL ,
.BR SCTP_RTO_INITIAL ,
.BR SCTP_RTO_MIN ,
.BR SCTP_RTO_MAX ,
.BR SCTP_OSTREAMS ,
.BR SCTP_ISTREAMS ,
.BR SCTP_COOKIE_INC ,
.BR SCTP_THROTTLE_ITVL ,
.BR SCTP_MAC_TYPE ,
.BR SCTP_CKSUM_TYPE ,
.BR SCTP_DEBUG_OPTIONS ,
.BR SCTP_STATUS ,
and
.B SCTP_DISPOSITION
are new for 2.4.
.SH "SEE ALSO"
.BR socket (7),
.BR socket (2),
.BR ip (7),
.BR sendmsg (7),
.BR recvmsg (7),
.BR bind (2),
.BR getsockname (2),
and
.BR getpeername (2).

.SH "REFERENCES"
RFC2960 for the SCTP specification.
.br
draft-ietf-tsvwg-sctpsocket-03.txt
for the description of a TCP-compatible SCTP API for sockets.
.br
RFC1122 for a description of the Nagle algorithm.
.br
draft-ietf-tsvwg-sctpcsum-06.txt
for a description of the CRC-32c checksum algorithm.
.SH "COPYRIGHT NOTICE"
